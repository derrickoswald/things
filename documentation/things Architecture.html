<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<title></title>
	<meta name="generator" content="LibreOffice 4.2.7.2 (Linux)">
	<meta name="created" content="20150313;103121795478002">
	<meta name="changed" content="20150313;160227432643108">
	<style type="text/css">
	<!--
		@page { margin: 0.79in }
		p { margin-bottom: 0.1in; line-height: 120% }
		h1 { margin-bottom: 0.08in }
		h1.western { font-family: "Liberation Sans", sans-serif; font-size: 18pt }
		h1.cjk { font-family: "Droid Sans Fallback"; font-size: 18pt }
		h1.ctl { font-family: "FreeSans"; font-size: 18pt }
		a:link { so-language: zxx }
	-->
	</style>
</head>
<body lang="en-US" dir="ltr">
<p align="center" style="margin-top: 0.17in; margin-bottom: 0.08in; line-height: 100%; page-break-after: avoid">
<font face="Liberation Sans, sans-serif"><font size="6" style="font-size: 28pt"><b><i>things</i>
Architecture</b></font></font></p>
<h1 class="western">Overview</h1>
<p style="margin-bottom: 0in; line-height: 100%">The <i>things</i>
application is a client-server system intended to create, manage and
share <i>thing</i> objects. <i>Things</i> are torrent files with
additional metadata as specified by the Thing Tracker Network{link}
as well as the files that are identified by the torrent's file list
and normally distributed using bittorrent technology. A simplified
view of a sample <i>thing</i> is shown in Figure 1.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">[Figure 1 –
Simplified view of a sample thing]</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">The three main
components of the system are the <a href="http://couchdb.org/" name="couchdb" target="_blank">couchdb
database</a>{check capitalization and official names}, the <a href="http://deluge.org/" name="deluge" target="_blank">Deluge
bittorent client</a>, and an HTML5 compatible browser such as Chrome
or Firefox. A simplified view of the application is shown in Figure
2.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">[Figure 2 –
Simplified diagram of the <i>things</i> application]</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<h1 class="western">Client</h1>
<p style="margin-bottom: 0in; line-height: 100%">{link to another
page with a short description of Javascript: ECMA, relation to java,
interactive, weakly typed, etc. }</p>
<p style="margin-bottom: 0in; line-height: 100%"> 
</p>
<p style="margin-bottom: 0in; line-height: 100%">In addition to the
RESTful API, the couchdb web server is used to serve static content,
including a number of javascript files which comprise the bulk of the
application logic, i.e. most application functionality is executing
on the client side. In addition to the application specific
Javascript files, the third party components that are used on the
client side of the application are:</p>
<ul>
	<li><p style="margin-bottom: 0in; line-height: 100%">jquery
	{version} (supercedes the jquery {version} that comes bundled with
	couchdb) is used to provide additional functionality to, and
	homogenization of, the javascript engines used by the supported
	browsers</p>
	<li><p style="margin-bottom: 0in; line-height: 100%">require
	{version} framework to structure the application code into modules
	and to handle dependencies when loading javascript files</p>
	<li><p style="margin-bottom: 0in; line-height: 100%">moustache
	{version} templating engine to provide HTML template processing that
	eases the repetitive and error-prone task of programatically
	generating HTML content from Javascript array of objects</p>
	<li><p style="margin-bottom: 0in; line-height: 100%">bootstrap
	{version} cascading style sheet (CSS) files and a corresponding
	javascript file that is used to provide industry standard styling
	and on-screen widgets and functionality</p>
</ul>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">Normally the jquery
and bootstrap components are served by content distribution networks
to ease bandwidth requirements of hostings systems, but a static
version of the start page can be used when off-line  to accomplish
basic workflows. A simplified view of the client side application is
shown in Figure 3.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">[Figure 3 –
Simplified diagram of client side components]</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<h1 class="western">Server</h1>
<p style="margin-bottom: 0in; line-height: 100%">{link to another
page with a short description of couchdb: nosql, JSON documents,
erlang, design documents, views, lists, versioning, replication,
etc.}</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">The databases hosted
by the couchdb server are:</p>
<ul>
	<li><p style="margin-bottom: 0in; line-height: 100%">things, the
	local database of user generated <i>things</i></p>
	<li><p style="margin-bottom: 0in; line-height: 100%">public_things,
	the replicated database of community published <i>things</i></p>
	<li><p style="margin-bottom: 0in; line-height: 100%">pending_things,
	the inbox for imported <i>things</i></p>
</ul>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">These databases have
design documents that provide data validation and views that are
specific to the application. To avoid cross-site scripting{link}, the
proxy capability of couchdb is used to federate services under one
url for consumption by the client. These services are:</p>
<ul>
	<li><p style="margin-bottom: 0in; line-height: 100%">Deluge web api
	which provides RESTful services to add, query and delete torrent
	files</p>
	<li><p style="margin-bottom: 0in; line-height: 100%">Keybase {link
	to keybase.io} which provides a RESTful api to retrieve security
	credentials</p>
</ul>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">The (lucene or solr)
text search engine is running on the same node as the database to
provide full text indexing. TBD</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">Multiple
installations of the <i>thing</i> application are joined together by
replication of the public_things database using the replication
functionality of couchdb, such that eventually all connected systems
will have a consistent view of all published <i>things</i>. A
simplified view of the server side application is shown in Figure 4.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">[Figure 4 –
Simplified diagram of server side components]</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<h1 class="western">User Scripts</h1>
<p style="margin-bottom: 0in; line-height: 100%">A few ancillary
components provide additional functionality to aid in importing
<i>things</i>. Greasemonkey scripts for Firefox and user scripts
{check name} for Chrome intercede on the users behalf to allow
seamless export from existing sites such as Thingiverse and Youmagine
and import to the <i>things</i> system. The couchdb CORS {link}
functionality is used to allow POST operations to couchdb while
visiting the existing site. The imported things are held in the
pending_things database until reviewed and posted to the
public_things database. A simplified view of these user scripts is
shown in Figure 5.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">[Figure 5 –
Simplified view of user script components]</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<h1 class="western">Operation</h1>
<p style="margin-bottom: 0in; line-height: 100%">The following
scenario describes a typical use-case where a designer wants to share
her designs on the Thing Tracker Network. It is just an example for
illustrative purposes and elides much detail in favor of simplicity.
Technical users should refer to the appropriate module for additional
details.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%">The designer has a
design that has met some milestone and she would like to share it
with colleagues in the community. She browses to a <i>things</i>
system running on her local machine. 
</p>
<p style="margin-bottom: 0in; line-height: 100%">Using the Thing
Wizard, she specifies the files to be included in the <i>thing</i>
and the metadata to associate with it and uploads the new <i>thing</i>
to her local things database. She could optionally use an existing
<i>thing</i> as a template to create a new version and/or she could
optionally sign the <i>thing</i> with her private key to  prove to
others that she made this <i>thing</i> and/or verify that the new
<i>thing</i> is a verified new version of the original.</p>
<p style="margin-bottom: 0in; line-height: 100%">She then publishes
the <i>thing</i> to the public_things database which also places the
torrent file and the associated files into Deluge. Deluge begins to
seed the thing as with any other torrent.</p>
<p style="margin-bottom: 0in; line-height: 100%">When the
public_things database is replicated to other systems, her new <i>thing</i>
is dispersed to these other systems as a document with an attached
torrent file.</p>
<p style="margin-bottom: 0in; line-height: 100%">Her new <i>thing</i>
is visible now when someone in the community browses or searches
their own copy of the public_thing database. Should they request the
<i>thing</i> be copied locally, their own <i>things</i> system places
the torrent file into Deluge. Deluge then begins the torrent download
and when it is finished, her design files are now available local
use.</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
<p style="margin-bottom: 0in; line-height: 100%"><br>
</p>
</body>
</html>